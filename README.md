# betagouv-ai-cli

> CLI to manage multi-tool AI configuration for beta.gouv.fr projects

## ğŸ¯ Why this CLI?

Beta.gouv.fr teams use different AI assistance tools (Claude Code, Cursor, GitHub Copilot). Each tool has its own configuration format, creating duplication and synchronization problems.

This CLI provides a **unified architecture** where:
- âœ… A single `.ai/` folder contains all directives
- âœ… Configurations are modular and maintainable
- âœ… All AI tools use the same foundation
- âœ… The team stays synchronized via git

## ğŸ“¦ Installation

```bash
# One-command installation (no dependencies required)
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/betagouv/ai-cli/main/install.sh)"
```

## ğŸš€ Quick Start

### New project

```bash
# In your project
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/betagouv/ai-cli/main/install.sh)"

# Answer the questions:
# - Project name
# - Description
# - Primary framework/language
# - AI tools to install (Claude Code, Cursor, Windsurf, Copilot)

# The .ai/ structure is automatically created and synchronized

# Commit
git add .ai/
git commit -m "feat: add AI configuration"
```

### Existing project with AI configs

```bash
# Manually migrate your existing files to .ai/
# then synchronize
bash templates/ides/<tool>/init.sh

# Verify migrated files
ls -la .ai/
```

## ğŸ“ Architecture

```
project/
â”œâ”€â”€ .ai/                          # ğŸ¯ SOURCE OF TRUTH (commit this)
â”‚   â”œâ”€â”€ AGENTS.md                 # Main config file (references other files)
â”‚   â”‚
â”‚   â”œâ”€â”€ context/                  # ğŸ“š Project knowledge base
â”‚   â”‚   â”œâ”€â”€ overview.md           # Project overview, tech stack
â”‚   â”‚   â”œâ”€â”€ architecture.md       # Architecture decisions
â”‚   â”‚   â”œâ”€â”€ testing.md            # Testing guidelines
â”‚   â”‚   â”œâ”€â”€ security.md           # Security best practices
â”‚   â”‚   â”œâ”€â”€ workflows.md          # Development workflows
â”‚   â”‚   â””â”€â”€ standards/
â”‚   â”‚       â””â”€â”€ common.md         # Standards common to all languages
â”‚   â”‚
â”‚   â”œâ”€â”€ commands/                 # Common commands (all IDEs)
â”‚   â”œâ”€â”€ agents/                   # Common agents
â”‚   â””â”€â”€ avatars/                  # AI behavior profiles
â”‚
â”œâ”€â”€ languages/                    # ğŸ—‚ï¸ Language-specific configs (commit this)
â”‚   â”œâ”€â”€ typescript/
â”‚   â”‚   â”œâ”€â”€ AGENTS.md             # TypeScript-specific guidelines
â”‚   â”‚   â”œâ”€â”€ standards.md          # TypeScript standards
â”‚   â”‚   â”œâ”€â”€ commands/             # TS-specific commands
â”‚   â”‚   â””â”€â”€ init.sh               # Setup script
â”‚   â”œâ”€â”€ python/
â”‚   â”‚   â”œâ”€â”€ AGENTS.md
â”‚   â”‚   â”œâ”€â”€ standards.md
â”‚   â”‚   â”œâ”€â”€ commands/
â”‚   â”‚   â””â”€â”€ init.sh
â”‚   â””â”€â”€ go/
â”‚       â”œâ”€â”€ AGENTS.md
â”‚       â””â”€â”€ init.sh
â”‚
â”œâ”€â”€ templates/                    # ğŸ”§ IDE setup scripts (downloaded during install)
â”‚   â””â”€â”€ ides/
â”‚       â”œâ”€â”€ claude/init.sh        # Setup Claude Code
â”‚       â”œâ”€â”€ cursor/init.sh        # Setup Cursor
â”‚       â”œâ”€â”€ windsurf/init.sh      # Setup Windsurf
â”‚       â””â”€â”€ copilot/init.sh       # Setup GitHub Copilot
â”‚
# â¬‡ï¸ GENERATED FILES (gitignored, created by init.sh):
â”‚
â”œâ”€â”€ .claude/                      # â† Generated by claude/init.sh
â”‚   â”œâ”€â”€ CLAUDE.md                 # Symlink to .ai/AGENTS.md
â”‚   â”œâ”€â”€ commands/                 # Symlink to .ai/commands/
â”‚   â”œâ”€â”€ agents/                   # Symlink to .ai/agents/
â”‚   â””â”€â”€ avatars/                  # Symlink to .ai/avatars/
â”‚
â”œâ”€â”€ .cursor/
â”‚   â””â”€â”€ rules/
â”‚       â”œâ”€â”€ main.mdc              # â† Symlink to .ai/AGENTS.md
â”‚       â”œâ”€â”€ context/              # â† Symlink to .ai/context/
â”‚       â””â”€â”€ languages/            # â† Symlink to languages/
â”‚
â”œâ”€â”€ .windsurf/
â”‚   â””â”€â”€ rules/
â”‚       â”œâ”€â”€ main.md               # â† Symlink to .ai/AGENTS.md
â”‚       â”œâ”€â”€ context/              # â† Symlink to .ai/context/
â”‚       â””â”€â”€ languages/            # â† Symlink to languages/
â”‚
â””â”€â”€ .github/
    â”œâ”€â”€ copilot-instructions.md   # â† Symlink to .ai/AGENTS.md
    â””â”€â”€ copilot/
        â”œâ”€â”€ context/              # â† Symlink to .ai/context/
        â””â”€â”€ languages/            # â† Symlink to languages/
```

### Principle

1. **Edit** files in `.ai/` (source of truth)
2. **Run** `bash templates/ides/<tool>/init.sh` to regenerate a tool's config
3. **Commit** only the `.ai/` folder
4. **Your AI tool** automatically loads the config (via symlinks or generated files)

## ğŸ› ï¸ init.sh Scripts per IDE

Each IDE has its own initialization script in `templates/ides/<tool>/init.sh`:

### Claude Code

```bash
bash templates/ides/claude/init.sh
```

**What it does:**
- Symlink `.claude/CLAUDE.md` â†’ `.ai/AGENTS.md`
- Symlink `.claude/commands/` â†’ `.ai/commands/` (entire folder)
- Symlink `.claude/agents/` â†’ `.ai/agents/` (entire folder)
- Symlink `.claude/avatars/` â†’ `.ai/avatars/` (entire folder)

âœ… **Dynamic**: Add a file to `.ai/commands/` and it appears automatically in Claude Code!

### Cursor

```bash
bash templates/ides/cursor/init.sh
```

**Ce qu'il fait :**
- GÃ©nÃ¨re `.cursor/rules/main.mdc` en fusionnant :
  - `.ai/AGENTS.md`
  - `.ai/context/*.md`
  - `languages/*/standards.md`

### Windsurf

```bash
bash templates/ides/windsurf/init.sh
```

**Ce qu'il fait :**
- GÃ©nÃ¨re `.windsurfrules` en fusionnant tous les contextes

### GitHub Copilot

```bash
bash templates/ides/copilot/init.sh
```

**Ce qu'il fait :**
- GÃ©nÃ¨re `.github/copilot-instructions.md` avec tous les contextes

## ğŸ“ Utilisation au quotidien

### Modifier les directives

```bash
# 1. Ã‰diter les fichiers sources
code .ai/context/standards/typescript.md

# 2. Pas besoin de sync si vous utilisez Claude (symlinks)
# Pour Cursor/Windsurf/Copilot, rÃ©gÃ©nÃ©rer :
bash templates/ides/cursor/init.sh

# 3. Committer uniquement .ai/
git add .ai/
git commit -m "docs: update TypeScript standards"

# 4. L'Ã©quipe rÃ©cupÃ¨re et rÃ©gÃ©nÃ¨re
git pull
bash templates/ides/cursor/init.sh  # Si nÃ©cessaire
```

### Ajouter une commande Claude Code

```bash
# 1. CrÃ©er le fichier
echo "---
commandName: deploy
---

Deploy application...
" > .ai/commands/deploy.md

# 2. DÃ©jÃ  disponible ! (symlink automatique)

# 3. Utiliser
claude
/deploy
```

### Ajouter une commande spÃ©cifique TypeScript

```bash
# 1. CrÃ©er dans languages/typescript/commands/
echo "---
commandName: ts-build
---

Build TypeScript project...
" > languages/typescript/commands/build.md

# 2. Accessible via .claude/commands/languages/typescript/commands/build.md
claude
/ts-build
```

### Directives spÃ©cifiques Ã  un module

Dans le README.md du module :

```markdown
# Module Auth

## Vue d'ensemble
...

## Directives IA

Lors du travail dans ce module :
- Utiliser JWT pour l'authentification
- Valider toutes les entrÃ©es avec Zod
- Ne jamais logger de donnÃ©es sensibles
```

## ğŸ”§ Configuration

### Templates

Le CLI inclut des templates franÃ§ais optimisÃ©s pour beta.gouv.fr :

- **overview.md** - Vue d'ensemble du projet
- **architecture.md** - DÃ©cisions d'architecture
- **coding-standards.md** - Standards de code
- **testing.md** - StratÃ©gie de test
- **security.md** - SÃ©curitÃ© (RGPD, best practices)
- **workflows.md** - Workflows de dÃ©veloppement

### Personnalisation

AprÃ¨s `init`, customisez les fichiers dans `.ai/` pour votre projet :

```bash
# Adapter pour votre stack
code .ai/overview.md

# DÃ©finir vos conventions
code .ai/coding-standards.md

# Documenter votre architecture
code .ai/architecture.md
```

## ğŸ¤ Outils supportÃ©s

| Outil | Support | Config gÃ©nÃ©rÃ©e |
|-------|---------|----------------|
| **Claude Code** | âœ… Full | `.claude/CLAUDE.md` + symlinks |
| **Cursor** | âœ… Full | `.cursor/rules/main.mdc` |
| **Windsurf** | âœ… Full | `.windsurfrules` |
| **GitHub Copilot** | âœ… Full | `.github/copilot-instructions.md` |
| **Continue** | âš ï¸ Partiel | Garde config existante |
| **Cody** | âœ… Via AGENTS.md | `AGENTS.md` racine |

## ğŸ’¡ Best Practices

### Commit uniquement .ai/

```bash
# âœ… Ã€ committer
.ai/

# âŒ GÃ©nÃ©rÃ© (gitignored)
AGENTS.md
.cursor/
.claude/
.github/copilot-instructions.md
```

### Garder les fichiers courts

- Chaque fichier `.ai/*.md` < 500 lignes
- SÃ©parer les concerns
- Lier vers docs externes si besoin

### Synchroniser aprÃ¨s pull

```bash
git pull

# Claude : Rien Ã  faire (symlinks dynamiques)
# Cursor/Windsurf/Copilot : RÃ©gÃ©nÃ©rer si contexte modifiÃ©
bash templates/ides/cursor/init.sh
```

### Directives impÃ©ratives

```markdown
# âœ… Bon
Utilisez TypeScript strict mode

# âŒ Ã€ Ã©viter
Nous prÃ©fÃ©rons utiliser TypeScript strict mode
```

Les IA rÃ©pondent mieux aux instructions directes.

## ğŸ› Troubleshooting

### L'IA ne suit pas les directives

1. **Claude** : VÃ©rifiez les symlinks (`ls -la .claude/commands/`)
2. **Cursor/Windsurf/Copilot** : RÃ©gÃ©nÃ©rez (`bash templates/ides/<tool>/init.sh`)
3. RÃ©fÃ©rencez explicitement : `@.ai/context/standards/typescript.md`
4. RedÃ©marrez votre outil IA

### Les symlinks ne fonctionnent pas (Windows)

**Solution** : Utiliser Cursor, Windsurf ou Copilot (pas de symlinks)

Pour Claude sur Windows :
1. Activer le mode dÃ©veloppeur Windows
2. Ou modifier `templates/ides/claude/init.sh` :
   ```bash
   # Remplacer ln -sf par cp
   cp -r .ai/commands/* .claude/commands/
   ```

### Conflit entre outils

- `.ai/` est la source de vÃ©ritÃ© unique
- RÃ©gÃ©nÃ©rez avec `bash templates/ides/<tool>/init.sh`
- Ne modifiez JAMAIS les fichiers gÃ©nÃ©rÃ©s (`.claude/`, `.cursor/`, etc.)

## ğŸ“š Ressources

- [Documentation complÃ¨te](https://github.com/betagouv/ai-cli/docs)
- [Exemples de projets](https://github.com/betagouv/ai-cli/examples)
- [Templates personnalisÃ©s](https://github.com/betagouv/ai-cli/templates)

## ğŸ¤ Contribution

Contributions bienvenues ! Voir [CONTRIBUTING.md](CONTRIBUTING.md).

### Proposer un template

Les Ã©quipes peuvent proposer leurs propres templates :

1. Fork le repo
2. Ajoutez votre template dans `templates/`
3. Documentez dans `templates/README.md`
4. Ouvrez une PR

## ğŸ“„ License

MIT Â© beta.gouv.fr

## ğŸ™‹ Support

- GitHub Issues : [betagouv/ai-cli/issues](https://github.com/betagouv/ai-cli/issues)
- Slack beta.gouv : `#incubateur-outils-dev`

---

Fait avec â¤ï¸ pour la communautÃ© beta.gouv.fr
